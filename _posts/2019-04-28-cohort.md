---
title: Cohort Analysis
author: Yu Donghwi
date: 2019-04-28
category: Jekyll
layout: post
---

### 1. Definition ###

 Actor를 시작 날짜를 기준으로 segment하여 cohort group으로 분류한 후 각 집단 별 retention에 기초해 이탈율, LTV(Life time value), returnship 등의 지표를 도출하는 데이터 분석 기법을 의미한다. 별도의 통계학, CS, AI에 대한 지식 없이 기초적인 RDBMS 쿼리를 통해 분석의 AtoZ를 수행할 수 있으며 강력한 비지니스 인사이트를 제공해줄 수 있어 Funnel 분석, A/B test와 함께 여러 분야에서 가장 많이 쓰이는 데이터 분석 기법이다.

>##### cohort
>
> 라틴어로 울타리를 뜻하는 cohortem에서 유래한 용어로서 '동질 집단'을 뜻한다. 특정 기간 동안 동일한 역사적 사건을 경험한 세대를 cohort로 정의하고 각 cohort의 행동 특성을 비교분석한 사회학 연구에서 시작하여 다양한 영역에서 cohort의 개념을 다루기 시작하였다. 빅데이터 분야에서 cohort란 주로 입학 날짜가 동일한 학생들, 같은 달에 가입한 온라인 쇼핑몰 회원 등 시작 날짜가 동일한 집단을 의미한다. 
{: .block-tip }



#### dataset

![](https://github.com/user-attachments/assets/c06bf7cc-8e20-4468-a692-326e7d3f2981)


cf) 분석에 사용된 dataset은 미국 국회의원의 인적사항 및 임기, 소속에 대한 자료이며 [이곳][1] 에서 접근 가능합니다.


### 2. Retention ###

retention의 사전적 의미는 '유지'이다. Cohort analysis에서 retention은 특정 시점에서 각 cohort 별로 이탈하지 않고 남아있는 고객의 비율을 의미한다.

#### 2-1. Deriving retention ####

```yaml
SELECT period
,first_value(cohort_retained) over (order by period) AS cohort_size
,cohort_retained
,cohort_retained/first_value(cohort_retained) over (order by period) AS pct_retained 
FROM
(
  SELECT timestampdiff(year, a.first_term, b.term_start) AS period
  , count(distinct a.id_bioguide) AS cohort_retained
  FROM
    (
     SELECT id_bioguide
     , min(term_start) as first_term 
	 FROM legislators_terms 
	 GROUP BY 1
	) a
  JOIN legislators_terms b ON a.id_bioguide = b.id_bioguide
  GROUP BY 1
) c
;

```

![](https://github.com/user-attachments/assets/2d239bd6-f44a-415a-af99-01db5727586e)
![](https://github.com/user-attachments/assets/1ea60bc8-6eac-4d1f-9428-8c40c1a57076)


#### 2-2. hyper-parameter tuning ####

### 3. Segmentation ### 

#### 3-1. Single relation ####

#### 3-2. Sub-query ####

#### 3-3. Rare cohort ####

#### 3-4. hyper-parameter tuning ####

### 4. Survival Analysis ###

### 5. Returnship Analysis ###

### 6. LTV Analysis ###



[1]: https://github.com/YuDH-DS/YuDH-DS.github.io/tree/main/_posts/cohort%EB%B6%84%EC%84%9D%20raw%20data